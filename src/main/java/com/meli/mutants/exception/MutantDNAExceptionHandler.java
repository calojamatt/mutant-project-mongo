/*
 * Development and Technologies Solutions S.A.S - D&TS
 * www.dytssol.com
 *
 * Copyright Â© 2015 - 2021
 * All right reserved.
 *
 * mutants-project
 * ExceptionHandler.java
 */
package com.meli.mutants.exception;

import com.meli.mutants.response.MutantDNAResponseHelper;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;

/**
 * Manages the different exceptions generated by Mutant Application endpoints
 *
 * @author <a href:"carlos.maturana@dytssol.com">Carlos Maturana</a>
 * @version 1.0.1
 * @created 7/03/21 10:26 a. m.
 * @since 1.0.0
 */
@ControllerAdvice
public class MutantDNAExceptionHandler {

    /**
     * This manages the exception triggered by the validation errors. Receive the exception and response with the
     * correct message according to the exception
     *
     * @param exception, The generated exception
     * @return ResponseEntity<Object>, the error message
     */
    @ExceptionHandler({NotValidDNASequenceException.class})
    protected ResponseEntity<Object> notValidDNASequenceExceptionHandler(Exception exception) {

        return new ResponseEntity<>(response(exception.getMessage()), HttpStatus.FORBIDDEN);
    }

    /**
     * This manages the exception triggered by the validation errors. Receive the exception and response with the
     * correct message according to the exception
     *
     * @param exception, The generated exception
     * @return ResponseEntity<Object>, the error message
     */
    @ExceptionHandler({Exception.class})
    protected ResponseEntity<Object> generalExceptionHandler(Exception exception) {

        return new ResponseEntity<>(response(exception.getMessage()), HttpStatus.FORBIDDEN);
    }

    /**
     * Builds the response to send
     *
     * @param message the message to send
     * @return MutantDNAResponseHelper
     * */
    private MutantDNAResponseHelper response(String message) {

        return MutantDNAResponseHelper.builder().errorMessage(message).build();
    }
}
